<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Socialify - Timeline</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="./Assets/CSS/style.css">
  </head>
  <body>
    <!-- Botón para regresar a la landpage -->
    <a href="index.html" class="back-button">&lt; Regresar</a>
    <!-- Icono de Perfil del Usuario -->
    <div class="profile-icon">
        <img id="profileIcon" class="rounded-circle" alt="Perfil" style="width: 50px; height: 50px; cursor: pointer;">
    </div>
  
    <!-- TIMELINE SECTION -->
    <section class="container py-5">
      <h2 class="text-center mb-4">Timeline</h2>
      <div class="row justify-content-center">
        <div class="col-md-8">

          <!-- Publicación 1 -->
          <div class="card mb-4 shadow-sm">
            <div class="card-body">
              <div class="d-flex align-items-center mb-3">
                <img src="https://i.pravatar.cc/50?img=1" alt="Avatar" class="rounded-circle me-3">
                <div>
                  <h5 class="card-title mb-0">john_doe</h5>
                  <small class="text-muted">John Doe</small>
                </div>
              </div>
              <img src="https://picsum.photos/600/400?random=1" class="card-img-top" alt="Publicación 1">
              <p class="mt-3">Explorando nuevos lugares. #viaje #aventura</p>
              <div class="d-flex align-items-center">
                <button class="btn btn-outline-danger btn-sm me-2 like-btn" data-likes="45">
                  <i class="bi bi-heart"></i> <span class="like-count">45</span> Likes
                </button>
              </div>
            </div>
          </div>

          <!-- Publicación 2 -->
          <div class="card mb-4 shadow-sm">
            <div class="card-body">
              <div class="d-flex align-items-center mb-3">
                <img src="https://i.pravatar.cc/50?img=2" alt="Avatar" class="rounded-circle me-3">
                <div>
                  <h5 class="card-title mb-0">jane_smith</h5>
                  <small class="text-muted">Jane Smith</small>
                </div>
              </div>
              <img src="https://picsum.photos/600/400?random=2" class="card-img-top" alt="Publicación 2">
              <p class="mt-3">Tiempo de relajación. #relax #paz</p>
              <div class="d-flex align-items-center">
                <button class="btn btn-outline-danger btn-sm me-2 like-btn" data-likes="30">
                  <i class="bi bi-heart"></i> <span class="like-count">30</span> Likes
                </button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- jQuery y Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.js"></script>
    
    <script>
        $(document).ready(function() {
          // Verificar si el usuario está logeado
          var loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
          if (!loggedInUser) {
            alert('Debes iniciar sesión para ver el timeline.');
            window.location.href = 'login.html';
          }
      
          // Mostrar foto de perfil fija
          $('#profileIcon').attr('src', 'https://i.pravatar.cc/150?img=7');
          $('#profileIcon').on('click', function() {
            window.location.href = 'perfil.html';
          });
      
          // Recuperar posts que han recibido like desde LocalStorage
          var likedPosts = JSON.parse(localStorage.getItem('likedPosts')) || [];
      
          $('.like-btn').each(function() {
            var $btn = $(this);
            var postId = $btn.closest('.card').index(); // Obtener índice del post
            var likeCount = $btn.find('.like-count');
            var likes = parseInt($btn.attr('data-likes')); // Obtener cantidad inicial de likes
      
            // Si el post ya tiene like, actualizar estilo
            if (likedPosts.includes(postId)) {
              $btn.addClass('liked btn-danger').removeClass('btn-outline-danger');
            }
      
            // Evento de click en el botón de like
            $btn.on('click', function() {
              if ($btn.hasClass('liked')) {
                likes--; // Quitar like
                $btn.removeClass('liked btn-danger').addClass('btn-outline-danger');
                likedPosts = likedPosts.filter(id => id !== postId);
              } else {
                likes++; // Dar like
                $btn.addClass('liked btn-danger').removeClass('btn-outline-danger');
                likedPosts.push(postId);
              }
      
              // Guardar en LocalStorage
              localStorage.setItem('likedPosts', JSON.stringify(likedPosts));
              likeCount.text(likes); // Actualizar número de likes
              $btn.attr('data-likes', likes); // Actualizar atributo de datos
            });
          });
        });
      </script>

    <!-- Estilos del Botón Regresar -->
    <style>
      body {
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .profile-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            border: 2px solid white;
            border-radius: 50%;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
       }

      .back-button {
        position: absolute;
        top: 20px;
        left: 20px;
        color: white;
        background: rgba(0, 0, 0, 0.5);
        padding: 8px 16px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        transition: background 0.3s;
      }

      .back-button:hover {
        background: rgba(0, 0, 0, 0.8);
      }

      .card {
        border: none;
        border-radius: 15px;
      }

      .like-btn.liked i {
        color: red;
      }
    </style>
  </body>
</html>
